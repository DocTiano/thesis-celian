<!-- Add Product Modal -->
<div class="modal fade" id="addProductModal" tabindex="-1" aria-labelledby="addProductModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addProductModalLabel">
                    <i class="bi bi-plus-circle"></i>
                    Add New Product
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="addProductForm">
                    <div class="row">
                        <div class="col-md-8">
                            <div class="form-group mb-3">
                                <label for="productName" class="form-label">Product Name *</label>
                                <input type="text" class="form-control" id="productName" name="productName" required>
                                <div class="form-text">Enter a clear, descriptive product name</div>
                            </div>
                            
                            <div class="form-group mb-3">
                                <label for="productDescription" class="form-label">Description *</label>
                                <textarea class="form-control" id="productDescription" name="productDescription" rows="4" required></textarea>
                                <div class="form-text">Describe your product in detail</div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group mb-3">
                                        <label for="productCategory" class="form-label">Category *</label>
                                        <select class="form-control" id="productCategory" name="productCategory" required>
                                            <option value="">Select Category</option>
                                            <option value="grains">Grains & Rice</option>
                                            <option value="vegetables">Vegetables</option>
                                            <option value="fruits">Fruits</option>
                                            <option value="seafood">Seafood</option>
                                            <option value="livestock">Livestock & Poultry</option>
                                            <option value="oils">Oils & Condiments</option>
                                            <option value="processed">Processed Foods</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group mb-3">
                                        <label for="productUnit" class="form-label">Unit of Measure *</label>
                                        <select class="form-control" id="productUnit" name="productUnit" required>
                                            <option value="">Select Unit</option>
                                            <option value="kg">Kilogram (kg)</option>
                                            <option value="g">Gram (g)</option>
                                            <option value="l">Liter (l)</option>
                                            <option value="ml">Milliliter (ml)</option>
                                            <option value="pcs">Pieces (pcs)</option>
                                            <option value="pack">Pack</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group mb-3">
                                        <label for="productPrice" class="form-label">Price (â‚±) *</label>
                                        <input type="number" class="form-control" id="productPrice" name="productPrice" step="0.01" min="0" required>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group mb-3">
                                        <label for="productStock" class="form-label">Initial Stock *</label>
                                        <input type="number" class="form-control" id="productStock" name="productStock" min="0" required>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group mb-3">
                                        <label for="productMinStock" class="form-label">Minimum Stock Alert</label>
                                        <input type="number" class="form-control" id="productMinStock" name="productMinStock" min="0" value="5">
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="form-group mb-3">
                                <label for="productImages" class="form-label">Product Images *</label>
                                <input type="file" class="form-control" id="productImages" name="productImages" multiple accept="image/*" required>
                                <div class="form-text">Upload up to 5 high-quality images</div>
                            </div>
                            
                            <div class="image-preview mt-3" id="imagePreview">
                                <!-- Image previews will appear here -->
                            </div>
                            
                            <div class="form-group mt-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="organicCertified" name="organicCertified">
                                    <label class="form-check-label" for="organicCertified">
                                        Organic Certified
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="locallySourced" name="locallySourced" checked>
                                    <label class="form-check-label" for="locallySourced">
                                        Locally Sourced
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="alert alert-info">
                        <i class="bi bi-info-circle"></i>
                        <strong>Note:</strong> Your product will be submitted for LGU price validation before it becomes available to customers.
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" class="btn-seller" form="addProductForm">
                    <i class="bi bi-check-circle"></i>
                    Submit for Approval
                </button>
            </div>
        </div>
    </div>
</div>

<script>
document.getElementById('productImages').addEventListener('change', function(e) {
    const preview = document.getElementById('imagePreview');
    preview.innerHTML = '';
    
    const files = Array.from(e.target.files);
    
    if (files.length > 5) {
        alert('You can only upload up to 5 images');
        this.value = '';
        return;
    }
    
    files.forEach((file, index) => {
        if (file.type.startsWith('image/')) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const imgDiv = document.createElement('div');
                imgDiv.className = 'position-relative mb-2';
                imgDiv.innerHTML = `
                    <img src="${e.target.result}" class="img-thumbnail" style="width: 100%; height: 80px; object-fit: cover;">
                    <button type="button" class="btn btn-sm btn-danger position-absolute top-0 end-0" onclick="this.parentElement.remove()">
                        <i class="bi bi-x"></i>
                    </button>
                `;
                preview.appendChild(imgDiv);
            };
            reader.readAsDataURL(file);
        }
    });
});

document.getElementById('addProductForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    // Simulate form submission
    const formData = new FormData(this);
    
    // Show success message
    window.sellerDashboard.showSuccessMessage('Product submitted for LGU approval successfully!');
    
    // Close modal
    const modal = bootstrap.Modal.getInstance(document.getElementById('addProductModal'));
    modal.hide();
    
    // Reset form
    this.reset();
    document.getElementById('imagePreview').innerHTML = '';
});
</script>
